<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>BizDoc — Summarize & Download</title>
<style>
  body{margin:0;background:#fff;font-family:system-ui,sans-serif;color:#222;display:flex;align-items:center;justify-content:center;height:100vh}
  .card{border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.06);padding:36px;text-align:center;max-width:520px;width:92%}
  h1{margin:0 0 10px} p{color:#555;margin:0 0 18px}
  input[type=file]{display:block;margin:14px auto 10px;padding:10px;border:1px solid #ddd;border-radius:8px;width:80%}
  .btn{background:#4fc3f7;color:#fff;border:none;padding:14px 28px;border-radius:10px;cursor:pointer;font-size:16px}
  .btn:hover{background:#29b6f6} #log{margin-top:14px;color:#333;font-size:14px;min-height:18px}
</style></head><body>
<div class="card"><h1>Summarize & Download</h1>
<p>Upload a PDF (≤ 5 MB). We’ll OCR, analyze with OpenAI, fact-check on the web, add charts, and download a polished report.</p>
<input id="pdfFile" type="file" accept="application/pdf"/>
<input id="reportName" value="BizDoc_Summary" style="padding:8px;border:1px solid #ddd;border-radius:8px;width:80%"/>
<div class="row"><button class="btn" id="go">Download Report</button></div><div id="log"></div></div>
<script>
const log=t=>document.getElementById('log').textContent=t;
const dl=(blob,name)=>{const u=URL.createObjectURL(blob);const a=document.createElement('a');a.href=u;a.download=name;a.click();URL.revokeObjectURL(u)};
document.getElementById('go').addEventListener('click',async()=>{
  const f=document.getElementById('pdfFile').files[0]; const name=(document.getElementById('reportName').value||'BizDoc_Summary').trim();
  if(!f) return log('Choose a PDF first'); if(f.size>5*1024*1024) return log('Max size 5MB');
  const reader=new FileReader(); reader.onload=async()=>{
    try{ log('Analyzing with OpenAI + web research…');
      const r=await fetch('/api/summarize-download',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({ pdfDataUrl: reader.result, filename: name })});
      if(!r.ok) throw new Error(await r.text()); const b=await r.blob(); dl(b, name+'.pdf'); log('✅ Done. Report downloaded.');
    }catch(e){ log('❌ '+(e.message||e)); }
  }; reader.readAsDataURL(f);
});
</script></body></html>
